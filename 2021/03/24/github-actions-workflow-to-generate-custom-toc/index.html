<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  
  
  <title>Github actions workflow to generate custom TOC</title>
  <meta name="description" content="Background Other than writing code, I have been using github for storing and organizing my daily notes. Github allows simplicity and flexibility to work with markdown notes, further it has the ability to version the files and view them across multiple devices. But as the total number of the file grows navigation becomes a bottleneck. To tackle this issue I am generating a table of content(TOC) in the README so that I can quickly access a file from the README itself. The other advantage it provides is I get a summary of all notes I have in the project. In this article, I am going to show you how to create a github actions workflow and make it generate the table of contents automatically for your project. Workflow Github Actions enables us to create workflows (like CI/CD capabilities) that can be integrated directly into our github code repository and runs on github hosted environments. These workflows are triggered automatically on occurrence of some event. I have all the code and files committed in this demo github repository toc-demo. This is how the file structure for the example project looks like. The github actions workflow is defined in a yaml file so we will create a file .github/workflows/action.yml. We will write a script that can generate the table of contents and then commit the changes and push! We will automate this workflow using the github actions. Workflow file name: toc-workflow-demo on: push: branches: [ main ] jobs: build: runs-on: ubuntu-latest steps: - name: checkout repo content uses: actions/checkout@v2 - name: setup python uses: actions/setup-python@v2 with: python-version: 3.8 - name: execute py script run: | python script.py - name: commit changes run: | git config user.name github-actions git config user.email github-actions@github.com echo `git add . &amp;amp;&amp;amp; git commit -m &quot;Auto generated commit&quot;` echo `git push` - name: Update Status run: | echo Updated Index successfully, echo Auto commit changes Summarizing the action file: the job is triggered when changes are pushed on to the main branch. the steps explained: the actions/checkout@v2 checks-out the repository toc-workflow-demo. the actions/setup-python@v2 setups python v3.8 in our actions environment. the job runs a script script.py to generate TOC and write to a file the end step is to commit the changes script made and push them to github. Script To generate TOC we require the name and path of all files. This python script reads through all files in the directory and generates a table of content in a tree hierarchy format. You can modify this script to create what fits you best. import os f=open(&#39;README.md&#39;,&#39;w+&#39;) f.write(&#39;# Notes&#39;) f.write(&#39;\n\n\n&#39;) startpath = &#39;./notes&#39; for root, dirs, files in os.walk(startpath): if root is not startpath: level = root.replace(startpath, &#39;&#39;).count(os.sep) -1 indent = &#39; &#39; * 2 * (level) f.write(&#39;{}- {}&#39;.format(indent, os.path.basename(root))) f.write(&#39;\n&#39;) subindent = &#39; &#39; * 2 * (level + 1) for file in files: path = os.path.join(root,file) f.write(&quot;{}- [{}]({})&quot;.format(subindent,file[:-3],path)) f.write(&#39;\n&#39;) Conclusion Once all the code changes are committed and code is pushed to github. Github actions will run the jobs and auto-commit the table of content to project README. The following table of content has been generated by the github actions in the demo project. We can click on the file name to navigate to the file. Next time any new file is added, removed or modified and committed to github, github actions will take care of generating the TOC in the project README.">
  

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://akatsuki06.github.io/2021/03/24/github-actions-workflow-to-generate-custom-toc/">
  
  
  <link rel="alternate" type="application/rss+xml" title="Blog" href="https://akatsuki06.github.io/feed.xml">

  

  
  <meta property="og:title" content="Github actions workflow to generate custom TOC">
  <meta property="og:site_name" content="Blog">
  <meta property="og:url" content="https://akatsuki06.github.io/2021/03/24/github-actions-workflow-to-generate-custom-toc/">
  <meta property="og:description" content="Background Other than writing code, I have been using github for storing and organizing my daily notes. Github allows simplicity and flexibility to work with markdown notes, further it has the ability to version the files and view them across multiple devices. But as the total number of the file grows navigation becomes a bottleneck. To tackle this issue I am generating a table of content(TOC) in the README so that I can quickly access a file from the README itself. The other advantage it provides is I get a summary of all notes I have in the project. In this article, I am going to show you how to create a github actions workflow and make it generate the table of contents automatically for your project. Workflow Github Actions enables us to create workflows (like CI/CD capabilities) that can be integrated directly into our github code repository and runs on github hosted environments. These workflows are triggered automatically on occurrence of some event. I have all the code and files committed in this demo github repository toc-demo. This is how the file structure for the example project looks like. The github actions workflow is defined in a yaml file so we will create a file .github/workflows/action.yml. We will write a script that can generate the table of contents and then commit the changes and push! We will automate this workflow using the github actions. Workflow file name: toc-workflow-demo on: push: branches: [ main ] jobs: build: runs-on: ubuntu-latest steps: - name: checkout repo content uses: actions/checkout@v2 - name: setup python uses: actions/setup-python@v2 with: python-version: 3.8 - name: execute py script run: | python script.py - name: commit changes run: | git config user.name github-actions git config user.email github-actions@github.com echo `git add . &amp;amp;&amp;amp; git commit -m &quot;Auto generated commit&quot;` echo `git push` - name: Update Status run: | echo Updated Index successfully, echo Auto commit changes Summarizing the action file: the job is triggered when changes are pushed on to the main branch. the steps explained: the actions/checkout@v2 checks-out the repository toc-workflow-demo. the actions/setup-python@v2 setups python v3.8 in our actions environment. the job runs a script script.py to generate TOC and write to a file the end step is to commit the changes script made and push them to github. Script To generate TOC we require the name and path of all files. This python script reads through all files in the directory and generates a table of content in a tree hierarchy format. You can modify this script to create what fits you best. import os f=open(&#39;README.md&#39;,&#39;w+&#39;) f.write(&#39;# Notes&#39;) f.write(&#39;\n\n\n&#39;) startpath = &#39;./notes&#39; for root, dirs, files in os.walk(startpath): if root is not startpath: level = root.replace(startpath, &#39;&#39;).count(os.sep) -1 indent = &#39; &#39; * 2 * (level) f.write(&#39;{}- {}&#39;.format(indent, os.path.basename(root))) f.write(&#39;\n&#39;) subindent = &#39; &#39; * 2 * (level + 1) for file in files: path = os.path.join(root,file) f.write(&quot;{}- [{}]({})&quot;.format(subindent,file[:-3],path)) f.write(&#39;\n&#39;) Conclusion Once all the code changes are committed and code is pushed to github. Github actions will run the jobs and auto-commit the table of content to project README. The following table of content has been generated by the github actions in the demo project. We can click on the file name to navigate to the file. Next time any new file is added, removed or modified and committed to github, github actions will take care of generating the TOC in the project README.">
  
  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:title" content="Github actions workflow to generate custom TOC">
  <meta name="twitter:description" content="Background Other than writing code, I have been using github for storing and organizing my daily notes. Github allows simplicity and flexibility to work with markdown notes, further it has the abil...">
  
  

  <link rel="dns-prefetch" href="https://fonts.gstatic.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css?family=Poppins:wght,400i,700&amp;display=swap" rel="stylesheet">


  
  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-105829162-2', 'auto');
    ga('send', 'pageview');

  </script>


</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Blog</a>

    <nav class="site-nav">
      
        
        <a class="page-link" href="/archives/">archives</a>
      
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    
      <h1 class="post-title" itemprop="name headline">Github actions workflow to generate custom TOC</h1>
    
    <p class="post-meta"><time datetime="2021-03-24T05:31:56+00:00" itemprop="datePublished">Mar 24, 2021</time> â€¢
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/github/">github</a>,
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/automation/">automation</a>
      
    
  



</p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <h2><u>Background</u></h2>

<p>Other than writing code, I have been using github for storing and organizing my daily notes. Github allows simplicity and flexibility to work with markdown notes, further it has the ability to version the files and view them across multiple devices. But as the total number of the file grows navigation becomes a bottleneck.
To tackle this issue I am generating a table of content(TOC) in the README so that I can quickly access a file from the README itself. The other advantage it provides is I get a summary of all notes I have in the project.</p>

<p>In this article, I am going to show you how to create a github actions workflow and make it generate the table of contents automatically for your project.</p>

<h2><u>Workflow</u></h2>

<p>Github Actions enables us to create workflows (like CI/CD capabilities) that can be integrated directly into our github code repository and runs on github hosted environments. These workflows are triggered automatically on occurrence of some event.</p>

<p>I have all the code and files committed in this demo github repository <a href="https://github.com/Akatsuki06/toc-workflow-demo">toc-demo</a>.
This is how the file structure for the example project looks like.</p>

<p align="center">
  <img src="https://user-images.githubusercontent.com/16136908/112720042-278acd00-8f22-11eb-9b4e-82c7b2b2f776.png" alt="Sublime's custom image" />
</p>

<p>The github actions workflow is defined in a yaml file so we will create a file <code class="language-plaintext highlighter-rouge">.github/workflows/action.yml</code>.</p>

<p>We will write a script that can generate the table of contents and then commit the changes and push! We will automate this workflow using the github actions.</p>

<h3>Workflow file</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">toc-workflow-demo</span>
<span class="na">on</span><span class="pi">:</span>
  <span class="na">push</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span> <span class="nv">main</span> <span class="pi">]</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">checkout repo content</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v2</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">setup python</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/setup-python@v2</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">python-version</span><span class="pi">:</span> <span class="m">3.8</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">execute py script</span>
        <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
          <span class="s">python script.py</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">commit changes</span>
        <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
          <span class="s">git config user.name github-actions</span>
          <span class="s">git config user.email github-actions@github.com</span>
          <span class="s">echo `git add . &amp;&amp; git commit -m "Auto generated commit"`</span>
          <span class="s">echo `git push`</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Update Status</span>
        <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
          <span class="s">echo Updated Index successfully,</span>
          <span class="s">echo Auto commit changes</span>
</code></pre></div></div>

<p>Summarizing the action file:</p>

<ul>
  <li>the job is triggered when changes are pushed on to the <code class="language-plaintext highlighter-rouge">main</code> branch.</li>
  <li>the steps explained:
    <ul>
      <li>the <code class="language-plaintext highlighter-rouge">actions/checkout@v2</code> checks-out the repository <code class="language-plaintext highlighter-rouge">toc-workflow-demo</code>.</li>
      <li>the <code class="language-plaintext highlighter-rouge">actions/setup-python@v2</code> setups python v3.8 in our actions environment.</li>
      <li>the job runs a script  <code class="language-plaintext highlighter-rouge">script.py</code> to generate TOC and write to a file</li>
      <li>the end step is to commit the changes script made and push them to github.</li>
    </ul>
  </li>
</ul>

<h3>Script</h3>

<p>To generate TOC we require the name and path of all files.
This python script reads through all files in the directory and generates a table of content in a tree hierarchy format. You can modify this script to create what fits you best.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
             
<span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s">'README.md'</span><span class="p">,</span><span class="s">'w+'</span><span class="p">)</span>
<span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'# Notes'</span><span class="p">)</span>
<span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'</span><span class="se">\n\n\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">startpath</span> <span class="o">=</span> <span class="s">'./notes'</span>

<span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="n">walk</span><span class="p">(</span><span class="n">startpath</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">root</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">startpath</span><span class="p">:</span>
      <span class="n">level</span> <span class="o">=</span> <span class="n">root</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="n">startpath</span><span class="p">,</span> <span class="s">''</span><span class="p">).</span><span class="n">count</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">sep</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span>
      <span class="n">indent</span> <span class="o">=</span> <span class="s">' '</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">level</span><span class="p">)</span>
      <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'{}- {}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">basename</span><span class="p">(</span><span class="n">root</span><span class="p">)))</span>
      <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
      <span class="n">subindent</span> <span class="o">=</span> <span class="s">' '</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
      <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="nb">file</span><span class="p">)</span>
        <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"{}- [{}]({})"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">subindent</span><span class="p">,</span><span class="nb">file</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span><span class="n">path</span><span class="p">))</span>
        <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
</code></pre></div></div>

<h3><u>Conclusion</u></h3>

<p>Once all the code changes are committed and code is pushed to github. Github actions will run the jobs and auto-commit the table of content to project README.
The following table of content has been generated by the github actions in the demo project.
We can click on the file name to navigate to the file.
<img src="https://user-images.githubusercontent.com/16136908/112727828-48671880-8f4a-11eb-99e5-5c7f8858fc16.png" alt="image" /></p>

<p>Next time any new file is added, removed or modified and committed to github, github actions will take care of generating the TOC in the project README.</p>

  </div>

  

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <p>
      

&copy; akatsuki06<br>
 Powered by <a href="https://pages.github.com/">Github Pages</a> <br>Theme by <a href="https://github.com/yous/whiteglass">Whiteglass</a> <br>
 <!-- Subscribe via <a href="https://akatsuki06.github.io/feed.xml">RSS</a> -->

    </p>

  </div>

</footer>


  </body>

</html>
